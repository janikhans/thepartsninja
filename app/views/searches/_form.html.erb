<%= simple_form_for :search, url: search_path, method: :get do |f| %>
    <div class="row">
        <%= f.input :year, class:"form-control", collection: 1955..2017, prompt: "Year...", label: false %>
        <%= f.input :brand, collection: Brand.joins(:vehicles).select("DISTINCT brands.*").order(name: :asc), class:"form-control", required: true, label: false, prompt: "Make..." %>
        <%= f.input :model, collection: [], class:"form-control", required: true, label: false, prompt: "Select a Brand..."%>
        <%#= f.autocomplete_field :brand, autocomplete_brand_name_pages_path, placeholder: "Make...", class:"form-control", required: true %>
        <%#= f.input :make, class:"form-control", collection: Brand.all.order(:name), include_blank: false, label: false %>
        <%#= f.input :brand, class:"form-control", placeholder: "Make...", label: false %>
        <%#= f.autocomplete_field :model, autocomplete_vehicle_model_pages_path, placeholder: "Model...", class:"form-control", required: true %>
        <%#= f.input :model, class:"form-control", collection: Vehicle.all.order(:model), label_method: :to_label, value_method: :id, include_blank: false, label: false %>
        <%#= f.input :model, class:"form-control", placeholder: "Model...", label: false %>
        <%= f.autocomplete_field :part, autocomplete_category_name_pages_path, placeholder: "What Part...", class:"form-control", required: true %>
        <%#= f.input :part, class:"form-control", collection: Category.all, as: :grouped_select, group_method: :subcategories, value_method: :name, placeholder: "What Part?", include_blank: false, label: false %>
      <div class="text-center">
        <%= f.submit("Search", class:"btn btn-default submit-btn") %>
      </div>
    </div>
<% end %>

<script type="text/javascript">
  $("#search_brand").on("change", function() {
    var brandId = $(this).val();
    if (brandId > 0 ) {
      return $.ajax({
        url: "/brands/"+brandId+"/models",
        type: "GET"
      });
    } else {
      $('#search_model').empty();
      $('#search_model').append($("<option></option>").text('Select a Brand...'));
    };
  });
</script>
